<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lord of the rings accessibility quiz</title>
    <link rel="stylesheet" href="css/styles.css" />
  <!-- EMAX Image Optimizer -->
<script>
(function() {
  var PROXY_URL = 'https://img.caspianalmerud.se/img/3';
  var STATUS_URL = 'https://img.caspianalmerud.se/api/status/3';
  var SITE_DOMAIN = 'accessiblesauron.netlify.app';
  var TIMEOUT_MS = 2e3;
  var MAX_FAILURES = 3;
  var FAILURE_KEY = 'emax_failures';

  var failures = parseInt(sessionStorage.getItem(FAILURE_KEY) || '0', 10);
  if (failures >= MAX_FAILURES) return;

  var statusCheck = new XMLHttpRequest();
  statusCheck.open('GET', STATUS_URL, true);
  statusCheck.timeout = TIMEOUT_MS;
  statusCheck.onload = function() {
    if (statusCheck.status === 200) {
      rewriteImages();
      observeDOM();
    }
  };
  statusCheck.onerror = statusCheck.ontimeout = function() {
    sessionStorage.setItem(FAILURE_KEY, String(failures + 1));
  };
  statusCheck.send();

  function rewriteImages() {
    document.querySelectorAll('img').forEach(function(img) {
      rewriteSrc(img, 'src');
      rewriteSrc(img, 'data-src');
      rewriteSrcset(img, 'srcset');
      rewriteSrcset(img, 'data-srcset');
    });

    document.querySelectorAll('source').forEach(function(source) {
      rewriteSrcset(source, 'srcset');
    });
  }

  function rewriteSrc(el, attr) {
    var val = el.getAttribute(attr);
    if (!val) return;
    var rewritten = rewriteUrl(val);
    if (rewritten !== val) el.setAttribute(attr, rewritten);
  }

  function rewriteSrcset(el, attr) {
    var val = el.getAttribute(attr);
    if (!val) return;
    var parts = val.split(',').map(function(entry) {
      var pieces = entry.trim().split(/\s+/);
      var widthHint = extractWidthDescriptor(pieces[1]);
      pieces[0] = rewriteUrl(pieces[0], widthHint);
      return pieces.join(' ');
    });
    el.setAttribute(attr, parts.join(', '));
  }

  function extractWidthDescriptor(descriptor) {
    if (!descriptor) return null;
    var match = descriptor.match(/^(\d+)w$/i);
    return match ? match[1] : null;
  }

  function rewriteUrl(url, widthHint) {
    if (!url) return url;
    try {
      var parsed = new URL(url, window.location.origin);
      if (parsed.hostname !== SITE_DOMAIN) return url;
      if (!/\.(jpe?g|png|gif)(\?.*)?$/i.test(parsed.pathname)) return url;
      var proxied = PROXY_URL + parsed.pathname + parsed.search;
      if (widthHint) {
        proxied += (parsed.search ? '&' : '?') + 'w=' + widthHint;
      }
      return proxied;
    } catch (e) {
      return url;
    }
  }

  function observeDOM() {
    if (!window.MutationObserver) return;
    var observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        mutation.addedNodes.forEach(function(node) {
          if (node.nodeType === 1) {
            if (node.tagName === 'IMG') {
              rewriteSrc(node, 'src');
              rewriteSrc(node, 'data-src');
              rewriteSrcset(node, 'srcset');
              rewriteSrcset(node, 'data-srcset');
            }
            var imgs = node.querySelectorAll ? node.querySelectorAll('img') : [];
            imgs.forEach(function(img) {
              rewriteSrc(img, 'src');
              rewriteSrc(img, 'data-src');
              rewriteSrcset(img, 'srcset');
              rewriteSrcset(img, 'data-srcset');
            });
          }
        });
      });
    });
    observer.observe(document.body, { childList: true, subtree: true });
  }
})();
</script>
<!-- /EMAX Image Optimizer -->
  </head>
  <body>
    <a href="#main" class="skip-link">Skip to main content</a>
    <header id="header" role="banner">
      <div class="header-content">
        <h1>Web Accessibility Quiz</h1>
        <nav role="navigation" aria-label="Main navigation">
          <ul>
            <li>
              <a href="./index.html" aria-current="page">Home</a>
            </li>
            <li>
              <a href="about.html">About</a>
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <main id="main" role="main">
      <section id="quizIntroduction" aria-labelledby="intro-heading">
        <h2 id="intro-heading">Introduction</h2>
        <p>Welcome to our Web Accessibility Quiz! This interactive quiz will help you learn about web accessibility features while having fun with a Lord of the Rings theme. Each question explores different aspects of accessibility challenges and solutions.</p>
        <div class="image-container">
          <img 
            src="images/mountains.jpg" 
            id="mountains" 
            alt="" 
            role="presentation"
            aria-hidden="true" />
          <img 
            src="images/manga-mountains.jpg" 
            id="manga-mountains" 
            alt="Black and white painting of a mountainous landscape"
            width="400"
            height="300" />
        </div>
      </section>

      <section id="quizQuestions" aria-labelledby="quiz-heading">
        <h2 id="quiz-heading">Lord of the Rings Accessibility Quiz</h2>
        <form id="quiz-form" novalidate>
          <fieldset id="question1">
            <legend id="q1-legend">Who would have the hardest time using a computer, seen to their disability?</legend>
            <div role="radiogroup" aria-labelledby="q1-legend" aria-required="true" tabindex="0">
              <div class="radio-option">
                <input 
                  type="radio" 
                  id="question1-option1" 
                  name="question1"
                  value="smeagol"
                  required 
                  aria-describedby="error-question1" />
                <label for="question1-option1">
                  Smeagol (keeping track of profiles is hard enough)
                </label>
              </div>
              
              <div class="radio-option">
                <input 
                  type="radio" 
                  id="question1-option2" 
                  name="question1"
                  value="sauron"
                  required 
                  aria-describedby="error-question1" />
                <label for="question1-option2">
                  Sauron (having no body seems like an issue)
                </label>
              </div>
              
              <div class="radio-option">
                <input 
                  type="radio" 
                  id="question1-option3" 
                  name="question1"
                  value="tom"
                  required 
                  aria-describedby="error-question1" />
                <label for="question1-option3">
                  Tom Bombadil (ever heard about ADHD? Tom invented it)
                </label>
              </div>
            </div>
            <div class="error-message" id="error-question1" role="alert" aria-live="polite"></div>
          </fieldset>

          <fieldset id="question2">
            <legend id="q2-legend">What would be Frodo's biggest challenge in using a modern computer?</legend>
            <div role="radiogroup" aria-labelledby="q2-legend" aria-required="true" tabindex="0">
              <div class="radio-option">
                <input 
                  type="radio" 
                  id="question2-option1" 
                  name="question2"
                  value="keyboard"
                  required 
                  aria-describedby="error-question2" />
                <label for="question2-option1">Reaching the keyboard</label>
              </div>
              <div class="radio-option">
                <input 
                  type="radio" 
                  id="question2-option2" 
                  name="question2"
                  value="fingers"
                  required 
                  aria-describedby="error-question2" />
                <label for="question2-option2">Hairy fingers getting in the way of the mouse</label>
              </div>
              <div class="radio-option">
                <input 
                  type="radio" 
                  id="question2-option3" 
                  name="question2"
                  value="crumbles"
                  required 
                  aria-describedby="error-question2" />
                <label for="question2-option3">Cheese crumbles stuck in the keyboard</label>
              </div>
            </div>
            <div class="error-message" id="error-question2" role="alert" aria-live="polite"></div>
          </fieldset>

          <fieldset id="question3">
            <legend id="q3-legend">Who do you think has green/red color blindness?</legend>
            <div role="radiogroup" aria-labelledby="q3-legend" aria-required="true" tabindex="0">
              <div class="radio-option">
                <input 
                  type="radio" 
                  id="question3-option1" 
                  name="question3"
                  value="smeagol"
                  required 
                  aria-describedby="error-question3" />
                <label for="question3-option1">Smeagol</label>
              </div>
              <div class="radio-option">
                <input 
                  type="radio" 
                  id="question3-option2" 
                  name="question3"
                  value="samwise"
                  required 
                  aria-describedby="error-question3" />
                <label for="question3-option2">Samwise Gamgi</label>
              </div>
              <div class="radio-option">
                <input 
                  type="radio" 
                  id="question3-option3" 
                  name="question3"
                  value="gandalf"
                  required 
                  aria-describedby="error-question3" />
                <label for="question3-option3">Gandalf Grey</label>
              </div>
            </div>
            <div class="error-message" id="error-question3" role="alert" aria-live="polite"></div>
          </fieldset>

          <div id="feedback-region" class="sr-only" role="status" aria-live="polite"></div>
          <button type="submit">Submit Quiz</button>
        </form>
      </section>

      <section id="quizResults" aria-labelledby="results-heading">
        <h2 id="results-heading">Quiz Results</h2>
        <div role="status" aria-live="polite">
          <p>Your results will appear here after submitting the quiz.</p>
        </div>
      </section>
    </main>

    <footer role="contentinfo">
      <p>All rights reserved to Sauron, just trying to piss Middle Earth off.</p>
    </footer>

    <script src="js/main.js"></script>
  </body>
</html>
